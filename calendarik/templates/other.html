
{% load has_group %}
<html>
<head>
	<style>
   html, body, #wrapper {
	   font-size: 10px;
      height:100%;
      margin: 0;
      padding: 0;
      border: none;
      text-align: center;
   }
table {
font-size: 9px;
  border-collapse: collapse;
  table-layout: fixed;
  width: 100%;
}
p {
	margin: 0;
}
.request
	{
	border: 0px solid black;
	}

.confirmed
	{
	border: 0px solid black;
	background-color: red;
	}

.contract
	{
	border: 0px solid black;
	background-color: green;
}

.happening
	{
	border: 0px solid black;
	text-decoration: line-through;
}

.inner
	{
	border: 0px solid black;
	background-color: yellow;
}

.calendar_date {
	width: 1.5%;
}

.calendar_event {
	width: 11.5%;
  text-align: left;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
.menu {
  width: 120px;
  z-index: 1;
  box-shadow: 0 4px 5px 3px rgba(0, 0, 0, 0.2);
  position: fixed;
  display: none;
  transition: 0.2s display ease-in;
}
    .menu-option {
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
    }
.menu-option:hover {
  background-color: #f5f5f5;
}

td {
  text-align: left;
  border: 1px solid #dddddd;
}
th {
text-align: center;
}
	</style>
	</head>
<title>Travel</title>
</head>
<body>
	<form method="post" >
		{% csrf_token %}
		<div>
			<p class="dataset"><label>Event start:</label><input onchange="correct_date()" type="date" name="event_start_0" value="{{start_date}}" required><label>Event end:</label><input type="date" min={{start_date}} name="event_end_0">
		<button type="button" onClick="add_dataset()" id="add_more">+</button><button type="button" onClick="remove_dataset()">-</button></p>
		</div>
		{% if request.user|has_group:'Admin' %}

		<p><label>Will happen:</label><input type="checkbox" name="happening"></p>
		<p><label>Artist:</label><select name="artist">
			{% for artist in artists %}
				<option value="{{ artist.0 }}">{{ artist.1 }}</option>
			{% endfor %}
			</select></p>
		<p><label>Inner notes</label><textarea name="inner_notes"></textarea></p>
		<p><label>Inner files</label><input type="file" name="inner_files"></p>
		{% endif %}
		<p><label>Notes</label><textarea name="notes"></textarea></p>
		<p><label>Files</label><input type="file" name="files"></p>
	<input type="submit" value="Submit" />
	</form>
<script>
	function correct_date() {
		var dataset = document.getElementsByClassName("dataset");
		for (var i = 0; i < dataset.length; i++) {
			var start = dataset[i].childNodes[1].value;
			console.log(dataset[i].childNodes[3]);
			dataset[i].childNodes[3].setAttribute("min", start);
		}
	}
	function add_dataset() {
		var dataset = document.getElementsByClassName("dataset");
		var new_dataset = dataset[0].cloneNode(true);
		for (var i = 0; i < new_dataset.childNodes.length; i++) {
			var child = new_dataset.childNodes[i];
			if (child.name == undefined) {
				continue;
			}
			if (child.name.includes("event_start")) {
				child.name = "event_start_" + dataset.length;
			}
			if (child.name.includes("event_end")) {
				child.name = "event_end_" + dataset.length;
			}
		}
		dataset[0].parentNode.appendChild(new_dataset);
	}
	function remove_dataset() {
		var dataset = document.getElementsByClassName("dataset");
		if (dataset.length > 1) {
			dataset[0].parentNode.removeChild(dataset[dataset.length - 1]);
		}
	}
</script>
	</body>
	</html>
